# æ‘©å°”å­—ç¬¦ä¸²æœç´¢

> è¿™ä¸ªä¸»é¢˜çš„ç›¸å…³æ•™ç¨‹åœ¨[è¿™é‡Œ](https://www.raywenderlich.com/163964/swift-algorithm-club-booyer-moore-string-search-algorithm)

ç›®æ ‡ï¼šåœ¨ä¸å¼•å…¥ Foundation åº“å’Œä¸ä½¿ç”¨ `NSString` çš„ `rangeOfString()` æ–¹æ³•çš„å‰æä¸‹ï¼Œåªç”¨ Swift å®ç°ä¸€ä¸ªå­—ç¬¦ä¸²æœç´¢ç®—æ³•ã€‚

æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æƒ³è¦ç»™ `String` å®ç°ä¸€ä¸ªæ‰©å±•æ–¹æ³• `indexOf(pattern: String)` å¹¶è¿”å›ç¬¬ä¸€ä¸ªæœç´¢åˆ°çš„ç›®æ ‡æ¨¡å¼çš„ `String.Index`ï¼Œæˆ–è€…åœ¨æ‰¾ä¸åˆ°çš„æƒ…å†µä¸‹è¿”å› `nil`ã€‚

æ¯”æ–¹è¯´ï¼š

```swift
// è¾“å…¥ï¼š
let s = "Hello, World"
s.indexOf(pattern: "World")

// è¾“å‡ºï¼š
<String.Index?> 7

// è¾“å…¥ï¼š
let animals = "ğŸ¶ğŸ”ğŸ·ğŸ®ğŸ±"
animals.indexOf(pattern: "ğŸ®")

// è¾“å‡ºï¼š
<String.Index?> 6
```

> **æ³¨æ„ï¼š** ğŸ® çš„ä¸‹æ ‡æ˜¯ 6ï¼Œè€Œä¸æ˜¯é¢„æ–™ä¸­çš„ 3ï¼Œæ˜¯å› ä¸ºå­—ç¬¦ä¸²åœ¨å­˜å‚¨è¡¨æƒ…ç¬¦å·çš„æ—¶å€™ä¼šä½¿ç”¨æ›´å¤šçš„ç©ºé—´ã€‚ä¸è¿‡æ—¢ç„¶æ‰¾åˆ°äº†æ­£ç¡®çš„å­—ç¬¦ï¼Œ`String.Index` çš„å…·ä½“æ•°å€¼å°±ä¸é‡è¦äº†ã€‚

[ç©·ä¸¾æ³•](../Brute-Force%20String%20Search/)å·²ç»èƒ½ç”¨äº†ï¼Œä½†å®ƒå¹¶ä¸æ˜¯é‚£ä¹ˆé«˜æ•ˆï¼Œç‰¹åˆ«æ˜¯è¦æœç´¢å¤§é‡å­—ç¬¦ä¸²çš„æ—¶å€™ã€‚å…¶å®ä½ ä¸éœ€è¦æ£€ç´¢æºå­—ç¬¦ä¸²é‡Œçš„ _æ¯ä¸€ä¸ª_ å­—ç¬¦ â€”â€” ä½ æ€»æ˜¯èƒ½æ‰¾åˆ°æœºä¼šè·³è¿‡ä¸€äº›å­—ç¬¦ã€‚

è¿™ä¸ªèƒ½è·³è¿‡å­—ç¬¦çš„ç®—æ³•å°±æ˜¯å·²ç»å­˜åœ¨äº†å¾ˆä¹…çš„[æ‘©å°”å­—ç¬¦ä¸²æœç´¢](https://en.wikipedia.org/wiki/Boyerâ€“Moore_string_search_algorithm)ã€‚å®ƒè¿˜è¢«ç”¨ä½œæ‰€æœ‰å­—ç¬¦ä¸²æœç´¢ç®—æ³•çš„æ€§èƒ½åŸºå‡†ã€‚

ä¸‹é¢æ˜¯å…¶ä¸­ä¸€ç§ç”¨ Swift å®ç°çš„æ–¹å¼ï¼š

> **è¯‘è€…æ³¨ï¼š** ä¸ºäº†é¿å…æ··æ·†ï¼Œæå‰åšä¸ªåè¯è§£é‡Šï¼Œå‡è®¾æˆ‘ä»¬è¦åœ¨ä¸€ç¯‡æ–‡ç« ä¸­æ‰¾æŸä¸ªåå­—ï¼šâ€œç›®æ ‡å­—ç¬¦ä¸²â€æŒ‡çš„æ˜¯æˆ‘ä»¬è¦æ‰¾çš„å†…å®¹ï¼Œç›¸å½“äºæˆ‘ä»¬åœ¨æœç´¢æ¡†é‡Œè¾“å…¥çš„åå­—ï¼›â€œæºå­—ç¬¦ä¸²â€æŒ‡çš„æ˜¯æˆ‘ä»¬è¦å‘èµ·æŸ¥è¯¢çš„åœ°æ–¹ï¼Œç›¸å½“äºè¿™æ•´ç¯‡æ–‡ç« ã€‚

```swift
extension String {
    func index(of pattern: String) -> Index? {
        // æŠŠç›®æ ‡å­—ç¬¦ä¸²é•¿åº¦ä¿å­˜èµ·æ¥ï¼Œå› ä¸ºæˆ‘ä»¬æ¥ä¸‹æ¥ä¼šå¤šæ¬¡ç”¨ä¸Šå®ƒï¼Œè€Œè®¡ç®—é•¿åº¦æ˜¯æ¯”è¾ƒæ˜‚è´µçš„æ“ä½œ
        let patternLength = pattern.count
        guard patternLength > 0, patternLength <= count else { return nil }

        // æ„é€ â€œè·³è¿‡æŸ¥è¯¢è¡¨â€ã€‚
        // è¿™ä¸ªè¡¨ç”¨äºå†³å®šå½“ç›®æ ‡å­—ç¬¦ä¸²é‡Œçš„æŸä¸ªå­—ç¬¦æ²¡æ‰¾åˆ°æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥è·³è¿‡å¤šå°‘ä¸ªå­—ç¬¦
        var skipTable = [Character: Int]()
        for (i, c) in pattern.enumerated() {
            skipTable[c] = patternLength - i - 1
        }

        // è¿™æŒ‡å‘äº†ç›®æ ‡å­—ç¬¦ä¸²é‡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦
        let p = pattern.index(before: pattern.endIndex)
        let lastChar = pattern[p]

        // å› ä¸ºæˆ‘ä»¬ä¼šä»å³å¾€å·¦æ‰«æç›®æ ‡å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå…ˆå¾€å‰è·³è¿‡ç›®æ ‡å­—ç¬¦ä¸²é•¿åº¦é‚£ä¹ˆé•¿çš„è·ç¦»ã€‚
        // å‡ 1 æ˜¯å› ä¸º startIndex å·²ç»æŒ‡å‘äº†æºå­—ç¬¦ä¸²é‡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦
        var i = index(startIndex, offsetBy: patternLength - 1)

        // è¿™ä¸ªå·¥å…·æ–¹æ³•ç”¨æ¥åŒæ—¶åå‘éå†ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œ
        // ç›´åˆ°æ‰¾åˆ°å®ƒä»¬å­—ç¬¦ä¸ç›¸åŒçš„ä½ç½®ï¼Œæˆ–è€…ç›´åˆ°ä¸‹æ ‡å»åˆ°ç›®æ ‡å­—ç¬¦ä¸²çš„å¼€å¤´
        func backwards() -> Index? {
            var q = p
            var j = i
            while q > pattern.startIndex {
                j = index(before: j)
                q = index(before: q)
                if self[j] != pattern[q] { return nil }
            }
            return j
        }

        // ä¸»å¾ªç¯ã€‚ä¼šä¸€ç›´æ£€ç´¢åˆ°æºå­—ç¬¦ä¸²çš„ç»“å°¾ã€‚
        while i < endIndex {
            let c = self[i]

            // ç°åœ¨è¿™ä¸ªå­—ç¬¦è·Ÿç›®æ ‡å­—ç¬¦ä¸²é‡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦ä¸€æ ·å—ï¼Ÿ
            if c == lastChar {

                // æœ‰å¯èƒ½ä¼šåŒ¹é…ã€‚ç›´æ¥ç®€å•ç²—æš´åœ°ä»åå¾€å‰å¯¹æ¯”ã€‚
                if let k = backwards() { return k }

                // å¦‚æœä¸åŒ¹é…ï¼Œé‚£æˆ‘ä»¬åªèƒ½å¾€å‰è·³è¿‡ä¸€ä¸ªå­—ç¬¦ã€‚
                i = index(after: i)
            } else {
                // å­—ç¬¦ä¸ä¸€è‡´ï¼Œæ‰€ä»¥ä¸‹æ ‡å¾€å‰èµ°ã€‚å…·ä½“è¦è·³è¿‡å¤šå°‘ä¸ªå­—ç¬¦ç”±ä¹‹å‰æ„é€ çš„æŸ¥è¯¢è¡¨å†³å®šã€‚
                // å¦‚æœè¿™ä¸ªå­—ç¬¦æ²¡å‡ºç°åœ¨ç›®æ ‡å­—ç¬¦ä¸²é‡Œï¼Œé‚£æˆ‘ä»¬å¯ä»¥è·³è¿‡æ•´ä¸ªç›®æ ‡å­—ç¬¦ä¸²é‚£ä¹ˆé•¿ã€‚
                // ä½†æ˜¯ï¼Œå¦‚æœè¿™ä¸ªå­—ç¬¦æœ‰å‡ºç°åœ¨ç›®æ ‡å­—ç¬¦ä¸²é‡Œï¼Œè¯´æ˜æ¥ä¸‹æ¥è¿˜æœ‰å¯èƒ½ä¼šè¢«åŒ¹é…ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¸èƒ½è·³è¿‡é‚£ä¹ˆå¤šå­—ç¬¦äº†ã€‚
                i = index(i, offsetBy: skipTable[c] ?? patternLength, limitedBy: endIndex) ?? endIndex
            }
        }
        return nil
    }
}
```

ç®—æ³•æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚æŠŠç›®æ ‡å­—ç¬¦ä¸²å’Œæºå­—ç¬¦ä¸²æ’åœ¨ä¸€èµ·ï¼Œç„¶åçœ‹çœ‹å“ªä¸ªå­—ç¬¦è·Ÿç›®æ ‡å­—ç¬¦ä¸²é‡Œ _æœ€å_ é‚£ä¸ªå­—ç¬¦ä¸€æ ·ï¼š

```
source string:  Hello, World
search pattern: World
                    ^
```

> **è¯‘è€…æ³¨ï¼š** ä¸ºäº†å¯¹é½æ–‡å­—å’Œä¸‹é¢çš„æ ‡è®°ï¼Œè¿™é‡Œçš„æºå­—ç¬¦ä¸²ï¼ˆsource stringï¼‰å’Œç›®æ ‡å­—ç¬¦ä¸²ï¼ˆsearch patternï¼‰å°±æ²¡æœ‰ç¿»è¯‘äº†ã€‚

è¿™ä¼šæœ‰ä¸‰ç§å¯èƒ½çš„æƒ…å†µï¼š

1. ä¸¤ä¸ªå­—ç¬¦æ˜¯ä¸€æ ·çš„ï¼Œä½ å‘ç°äº†åŒ¹é…çš„å¯èƒ½æ€§ã€‚

2. ä¸¤ä¸ªå­—ç¬¦ä¸ä¸€æ ·ï¼Œä½†æ˜¯æºå­—ç¬¦ä¸²é‡Œçš„å­—ç¬¦åœ¨ç›®æ ‡å­—ç¬¦ä¸²é‡Œçš„å…¶ä»–ä½ç½®é‡Œå‡ºç°è¿‡ã€‚

3. æºå­—ç¬¦ä¸²é‡Œçš„å­—ç¬¦æ²¡æœ‰å‡ºç°åœ¨ç›®æ ‡å­—ç¬¦ä¸²é‡Œã€‚

åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œå­—ç¬¦ `o` å’Œ `d` ä¸ä¸€æ ·ï¼Œä½†æ˜¯ `o` å­˜åœ¨äºç›®æ ‡å­—ç¬¦ä¸²é‡Œçš„å…¶ä»–ä½ç½®ã€‚è¿™è¯´æ˜æˆ‘ä»¬å¯ä»¥å¾€å‰è·³è¿‡ä¸€äº›å­—ç¬¦ï¼š

```
source string:  Hello, World
search pattern:    World
                       ^
```

æ³¨æ„çœ‹ä¸¤ä¸ª `o` ç°åœ¨æ˜¯å¯¹é½çš„ã€‚å†æ¥ï¼Œä½ éœ€è¦æ¯”è¾ƒç›®æ ‡å­—ç¬¦ä¸²é‡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦å’Œæ­£åœ¨æ£€ç´¢çš„å­—ç¬¦ï¼š`d` vs `W`ã€‚å®ƒä»¬ä¸ä¸€æ ·ï¼Œä½†æ˜¯ `W` æœ‰å‡ºç°åœ¨ç›®æ ‡å­—ç¬¦ä¸²é‡Œã€‚æ‰€ä»¥å¾€å‰è·³è¿‡å­—ç¬¦ï¼Œè®©ä¸¤ä¸ª `W` å¯¹é½ï¼š

```
source string:  Hello, World
search pattern:        World
                           ^
```

è¿™æ¬¡ä¸¤ä¸ªå­—ç¬¦æ˜¯ä¸€æ ·çš„ï¼Œè€Œä¸”æœ‰åŒ¹é…çš„å¯èƒ½æ€§ã€‚ä¸ºäº†åˆ¤æ–­å®ƒä»¬æ˜¯ä¸æ˜¯çœŸçš„åŒ¹é…ï¼Œä½ éœ€è¦ä»åå¾€å‰æ‰§è¡Œä¸€ä¸ªç©·ä¸¾æ³•æ£€ç´¢ã€‚ç„¶åè¿™æ¬¡æœç´¢çš„å·¥ä½œå°±å…¨éƒ¨å®Œæˆäº†ã€‚

åœ¨ä»»ä½•æ—¶å€™ï¼Œå¾€å‰è·³è¿‡å¤šå°‘ä¸ªå­—ç¬¦éƒ½æ˜¯ç”±â€œè·³è¿‡æŸ¥è¯¢è¡¨â€å†³å®šçš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªå­˜æœ‰ç›®æ ‡å­—ç¬¦ä¸²é‡Œæ‰€æœ‰å­—ç¬¦å’Œè·³è¿‡è·ç¦»çš„å­—å…¸ã€‚ä¸Šè¿°ä¾‹å­é‡Œçš„æŸ¥è¯¢è¡¨æ˜¯è¿™æ ·çš„ï¼š

```
W: 4
o: 3
r: 2
l: 1
d: 0
```

å­—ç¬¦è¶Šé è¿‘å­—ç¬¦ä¸²çš„ç»“å°¾ï¼Œè·³è¿‡çš„è·ç¦»å°±è¶ŠçŸ­ã€‚å¦‚æœæŸä¸ªå­—ç¬¦åœ¨å­—ç¬¦ä¸²é‡Œå‡ºç°äº†ä¸æ­¢ä¸€æ¬¡ï¼Œé‚£ä¹ˆè·³è¿‡çš„è·ç¦»å°±ä»¥æ¥è¿‘å­—ç¬¦ä¸²ç»“å°¾çš„é‚£ä¸€ä¸ªä¸ºå‡†ã€‚

> **æ³¨æ„ï¼š** å¦‚æœç›®æ ‡å­—ç¬¦ä¸²åªæœ‰å¾ˆå°‘å‡ ä¸ªå­—ç¬¦ï¼Œç›´æ¥ç”¨ç®€å•çš„ç©·ä¸¾æ³•ä¼šæ›´å¿«ã€‚åœ¨å¤„ç†å¾ˆçŸ­çš„ç›®æ ‡å­—ç¬¦ä¸²æ—¶ï¼Œéœ€è¦æƒè¡¡æ„å»ºè·³è¿‡æŸ¥è¯¢è¡¨å’Œç›´æ¥ç©·ä¸¾æ³•ä¹‹é—´çš„ä¼˜åŠ£ã€‚

> è¿™æ®µä»£ç åŸºäºã€ŠDr Dobb'sã€‹æ‚å¿—äº1989å¹´7æœˆå‘è¡¨çš„æ–‡ç«  ["Faster String Searches" by Costas Menico](http://www.drdobbs.com/database/faster-string-searches/184408171) â€”â€”ä½ æ²¡çœ‹é”™ï¼Œ1989å¹´ï¼æœ‰æ—¶å€™ç•™ç€é‚£äº›æ—§æ‚å¿—è¿˜æ˜¯æŒºæœ‰ç”¨çš„ã€‚

ç›¸å…³ä¿¡æ¯ï¼šç®—æ³•çš„[ä¸€ä»½è¯¦ç»†åˆ†ææŠ¥å‘Š](http://www.inf.fh-flensburg.de/lang/algorithmen/pattern/bmen.htm)ã€‚

## Horspool ç®—æ³•

ä¸Šè¿°ç®—æ³•çš„ä¸€ç§å˜ä½“å« [Horspool ç®—æ³•](https://en.wikipedia.org/wiki/Boyer%E2%80%93Moore%E2%80%93Horspool_algorithm)ã€‚


å°±åƒåŸå§‹çš„æ‘©å°”ç®—æ³•é‚£æ ·ï¼Œå®ƒä¹Ÿç”¨äº† `skipTable` æ¥è·³è¿‡ä¸€äº›å­—ç¬¦ä¸²ã€‚åŒºåˆ«åœ¨äºæˆ‘ä»¬æ€ä¹ˆåˆ¤æ–­éƒ¨åˆ†åŒ¹é…ã€‚åœ¨ä¸Šé¢çš„ç‰ˆæœ¬é‡Œï¼Œå¦‚æœæ‰¾åˆ°äº†éƒ¨åˆ†è€Œä¸æ˜¯å®Œæ•´çš„åŒ¹é…ï¼Œæˆ‘ä»¬å°±åªå¾€å‰è·³ä¸€ä¸ªå­—ç¬¦ã€‚åœ¨è¿™ä¸ªä¿®æ”¹ç‰ˆæœ¬é‡Œï¼Œæˆ‘ä»¬åœ¨è¿™æ—¶å€™ä¹Ÿç”¨è·³è¿‡æŸ¥è¯¢è¡¨åŒºåˆ¤æ–­ã€‚

ä¸‹é¢æ˜¯ Horspool ç®—æ³•çš„å®ç°ï¼š

```swift
extension String {
    func index(of pattern: String) -> Index? {
        // æŠŠç›®æ ‡å­—ç¬¦ä¸²é•¿åº¦ä¿å­˜èµ·æ¥ï¼Œå› ä¸ºæˆ‘ä»¬æ¥ä¸‹æ¥ä¼šå¤šæ¬¡ç”¨ä¸Šå®ƒï¼Œè€Œè®¡ç®—é•¿åº¦æ˜¯æ¯”è¾ƒæ˜‚è´µçš„æ“ä½œ
        let patternLength = pattern.count
        guard patternLength > 0, patternLength <= characters.count else { return nil }

        // æ„é€ â€œè·³è¿‡æŸ¥è¯¢è¡¨â€ã€‚
        // è¿™ä¸ªè¡¨ç”¨äºå†³å®šå½“ç›®æ ‡å­—ç¬¦ä¸²é‡Œçš„æŸä¸ªå­—ç¬¦æ²¡æ‰¾åˆ°æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥è·³è¿‡å¤šå°‘ä¸ªå­—ç¬¦
        var skipTable = [Character: Int]()
        for (i, c) in pattern.enumerated() {
            skipTable[c] = patternLength - i - 1
        }

        // è¿™æŒ‡å‘äº†ç›®æ ‡å­—ç¬¦ä¸²é‡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦
        let p = pattern.index(before: pattern.endIndex)
        let lastChar = pattern[p]

        // å› ä¸ºæˆ‘ä»¬ä¼šä»å³å¾€å·¦æ‰«æç›®æ ‡å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå…ˆå¾€å‰è·³è¿‡ç›®æ ‡å­—ç¬¦ä¸²é•¿åº¦é‚£ä¹ˆé•¿çš„è·ç¦»ã€‚
        // å‡ 1 æ˜¯å› ä¸º startIndex å·²ç»æŒ‡å‘äº†æºå­—ç¬¦ä¸²é‡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦
        var i = index(startIndex, offsetBy: patternLength - 1)

        // è¿™ä¸ªå·¥å…·æ–¹æ³•ç”¨æ¥åŒæ—¶åå‘éå†ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œ
        // ç›´åˆ°æ‰¾åˆ°å®ƒä»¬å­—ç¬¦ä¸ç›¸åŒçš„ä½ç½®ï¼Œæˆ–è€…ç›´åˆ°ä¸‹æ ‡å»åˆ°ç›®æ ‡å­—ç¬¦ä¸²çš„å¼€å¤´
        func backwards() -> Index? {
            var q = p
            var j = i
            while q > pattern.startIndex {
                j = index(before: j)
                q = index(before: q)
                if self[j] != pattern[q] { return nil }
            }
            return j
        }

        // ä¸»å¾ªç¯ã€‚ä¼šä¸€ç›´æ£€ç´¢åˆ°æºå­—ç¬¦ä¸²çš„ç»“å°¾ã€‚
        while i < endIndex {
            let c = self[i]

            // ç°åœ¨è¿™ä¸ªå­—ç¬¦è·Ÿç›®æ ‡å­—ç¬¦ä¸²é‡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦ä¸€æ ·å—ï¼Ÿ
            if c == lastChar {

                // æœ‰å¯èƒ½ä¼šåŒ¹é…ã€‚ç›´æ¥ç®€å•ç²—æš´åœ°ä»åå¾€å‰å¯¹æ¯”ã€‚
                if let k = backwards() { return k }

                // ç¡®ä¿è‡³å°‘ä¼šè·³è¿‡ä¸€ä¸ªå­—ç¬¦
                // è¿™æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå­—ç¬¦ä¹Ÿåœ¨æŸ¥è¯¢è¡¨é‡Œï¼Œè€Œä¸” `skipTable[lastChar] = 0`
                let jumpOffset = max(skipTable[c] ?? patternLength, 1)
                i = index(i, offsetBy: jumpOffset, limitedBy: endIndex) ?? endIndex
            } else {
                // å­—ç¬¦ä¸ä¸€è‡´ï¼Œæ‰€ä»¥ä¸‹æ ‡å¾€å‰èµ°ã€‚å…·ä½“è¦è·³è¿‡å¤šå°‘ä¸ªå­—ç¬¦ç”±ä¹‹å‰æ„é€ çš„æŸ¥è¯¢è¡¨å†³å®šã€‚
                // å¦‚æœè¿™ä¸ªå­—ç¬¦æ²¡å‡ºç°åœ¨ç›®æ ‡å­—ç¬¦ä¸²é‡Œï¼Œé‚£æˆ‘ä»¬å¯ä»¥è·³è¿‡æ•´ä¸ªç›®æ ‡å­—ç¬¦ä¸²é‚£ä¹ˆé•¿ã€‚
                // ä½†æ˜¯ï¼Œå¦‚æœè¿™ä¸ªå­—ç¬¦æœ‰å‡ºç°åœ¨ç›®æ ‡å­—ç¬¦ä¸²é‡Œï¼Œè¯´æ˜æ¥ä¸‹æ¥è¿˜æœ‰å¯èƒ½ä¼šè¢«åŒ¹é…ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¸èƒ½è·³è¿‡é‚£ä¹ˆå¤šå­—ç¬¦äº†ã€‚
                i = index(i, offsetBy: skipTable[c] ?? patternLength, limitedBy: endIndex) ?? endIndex
            }
        }
        return nil
    }
}
```

åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œæ‘©å°”ç®—æ³•çš„ Horspool ç‰ˆæœ¬æ¯”åŸç‰ˆçš„æ€§èƒ½ä¼šå¥½ä¸Šé‚£ä¹ˆä¸€ç‚¹ç‚¹ã€‚ç„¶è€Œï¼Œè¿™è¿˜æ˜¯å–å†³äºä½ çš„æƒè¡¡å–èˆã€‚

> è¿™æ®µä»£ç åŸºäºè®ºæ–‡ï¼š[R. N. Horspool (1980). "Practical fast searching in strings". Software - Practice & Experience 10 (6): 501â€“506.](http://www.cin.br/~paguso/courses/if767/bib/Horspool_1980.pdf)

*åŸæ–‡å‡ºè‡ª Kelvin Lauã€‚ç”± Matthijs Hollemans è¿›è¡Œè¡¥å……ï¼Œå¹¶ç”± Andreas NeusÃ¼ÃŸã€[MatÃ­as Mazzei](https://github.com/mmazzei) æ›´æ–°*